# Settings for Cloud Run (your backend instance)
runConfig:
  cpu: 1
  memoryMiB: 1024
  ingress: ALL

# Environment variables and secrets for your runtime.
# Secrets MUST use the full resource path (projects/SOURCE_PROJECT_ID/secrets/SECRET_NAME) 
# because they live in a different project (eqpmgr-test).
env:
  # === EMAIL SECRETS (Source: eqpmgr-test) ===
  - variable: EMAIL_HOST
    secret: projects/eqpmgr-test/secrets/EMAIL_HOST
    availability:
      - RUNTIME
  - variable: EMAIL_PASS
    secret: projects/eqpmgr-test/secrets/EMAIL_PASS
    availability:
      - RUNTIME
  - variable: EMAIL_USER
    secret: projects/eqpmgr-test/secrets/EMAIL_USER
    availability:
      - RUNTIME

  # === FIREBASE CLIENT CONFIG (Client MUST connect to eqpmgr-test project) ===
  # All NEXT_PUBLIC variables must now use the public configuration of 'eqpmgr-test'
  # to ensure the client SDK can find the database and storage buckets.
  
  # API Key is sensitive; sourced from secret
  - variable: NEXT_PUBLIC_FIREBASE_API_KEY
    secret: projects/eqpmgr-test/secrets/FIREBASE_API_KEY
    availability:
      - BUILD
      - RUNTIME
      
  # CHANGED: These public IDs must now point to the correct data project (eqpmgr-test).
  - variable: NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN
    value: eqpmgr-test.firebaseapp.com # <-- CHANGED
    availability:
      - BUILD
      - RUNTIME
  - variable: NEXT_PUBLIC_FIREBASE_PROJECT_ID
    value: eqpmgr-test # <-- CHANGED
    availability:
      - BUILD
      - RUNTIME
  - variable: NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET
    value: eqpmgr-test.firebasestorage.app # <-- CHANGED
    availability:
      - BUILD
      - RUNTIME
  # UPDATED: App ID set to the value provided by you (from eqpmgrshop-central project).
  - variable: NEXT_PUBLIC_FIREBASE_APP_ID
    value: 1:195502058575:web:76582395d477eedb5d0e3a
    availability:
      - BUILD
      - RUNTIME

  # Required for non-public (server-side) Firebase admin/config loading.
  # These correctly point to the secrets project (eqpmgr-test).
  - variable: FIREBASE_API_KEY
    secret: projects/eqpmgr-test/secrets/FIREBASE_API_KEY
    availability:
      - BUILD
      - RUNTIME
  - variable: FIREBASE_PROJECT_ID
    secret: projects/eqpmgr-test/secrets/FIREBASE_PROJECT_ID
    availability:
      - BUILD
      - RUNTIME

  # === FIREBASE ADMIN SDK / SERVER CONFIG SECRETS (Source: eqpmgr-test) ===
  - variable: FIREBASE_CLIENT_EMAIL
    secret: projects/eqpmgr-test/secrets/FIREBASE_CLIENT_EMAIL
    availability:
      - RUNTIME
  - variable: FIREBASE_PRIVATE_KEY
    secret: projects/eqpmgr-test/secrets/FIREBASE_PRIVATE_KEY
    availability:
      - RUNTIME
  - variable: FIREBASE_CONFIG
    secret: projects/eqpmgr-test/secrets/FIREBASE_CONFIG
    availability:
      - BUILD
      - RUNTIME

  # === OTHER API KEYS (Source: eqpmgr-test) ===
  - variable: GEMINI_API_KEY
    secret: projects/eqpmgr-test/secrets/GEMINI_API_KEY
    availability:
      - BUILD
      - RUNTIME
  # REMOVED: NEXT_PUBLIC_GOOGLE_GEOCODING_API_KEY due to missing secret/permission error.

  # === STRIPE SECRETS (Source: eqpmgr-test) ===
  - variable: NEXT_PUBLIC_STRIPE_PRICE_ID
    secret: projects/eqpmgr-test/secrets/NEXT_PUBLIC_STRIPE_PRICE_ID
    availability:
      - BUILD
      - RUNTIME
  - variable: STRIPE_SECRET_KEY
    secret: projects/eqpmgr-test/secrets/STRIPE_SECRET_KEY
    availability:
      - RUNTIME
  # REMOVED: STRIPE_WEBHOOK_SECRET - Removed as it does not exist in your secret list.

# Arguments to pass to a build command (ensures consistency)
# These now explicitly reflect the correct data project (eqpmgr-test) configuration.
buildArgs:
  NEXT_PUBLIC_FIREBASE_API_KEY: ${secret:projects/eqpmgr-test/secrets/FIREBASE_API_KEY}
  NEXT_PUBLIC_FIREBASE_PROJECT_ID: eqpmgr-test # <-- CHANGED
  NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN: eqpmgr-test.firebaseapp.com # <-- CHANGED
  NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET: eqpmgr-test.firebasestorage.app # <-- CHANGED
